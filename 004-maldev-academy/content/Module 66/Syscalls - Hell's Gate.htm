<!DOCTYPE html>
<html class="dark"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie-edge">
        <meta name="csrf-token" content="YwmJrjvrFLFoheCqdySsfQHrDWEGzxTLXO7qfost">
        <link rel="stylesheet" href="Syscalls%20-%20Hell's%20Gate_files/template.css">
        <link rel="shortcut icon" href="https://maldevacademy.com/favicon.ico">
        <!-- fontawesome for icons -->
        <link rel="stylesheet" href="Syscalls%20-%20Hell's%20Gate_files/font-awesome.min.css">
        <!-- google fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="Syscalls%20-%20Hell's%20Gate_files/css2.css" rel="stylesheet">
        <link href="Syscalls%20-%20Hell's%20Gate_files/css2_002.css" rel="stylesheet">
        <title>Syscalls - Hell's Gate</title>
        <!-- Custom css files, order matters -->
        <link rel="preload" as="style" href="Syscalls%20-%20Hell's%20Gate_files/app.fdbb573b.css"><link rel="stylesheet" href="Syscalls%20-%20Hell's%20Gate_files/app.fdbb573b.css"><link rel="stylesheet" href="Syscalls%20-%20Hell's%20Gate_files/viewer.css">
    </head>
    <body>
        <nav id="navbar" class="px-2 sm:px-4 py-2.5 bg-gray-900 sticky hidden">
    <div class="container flex flex-wrap justify-between mx-auto">
      <a data-target="_self" href="https://maldevacademy.com/" class="flex items-center">
        <div class="main-logo flex flex-row items-center">
            <span class="text-xl logo-font text-white">MALDEV</span>
            <img class="w-[25px] mx-2 relative bottom-1" src="Syscalls%20-%20Hell's%20Gate_files/logo-bug-2.png" alt="Logo">   
            <span class="text-xl logo-font text-white">ACADEMY</span>          
        </div>
      </a>
      <button data-collapse-toggle="navbar-default" id="navbar-phone-btn" type="button" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
      </button>
      <div class="hidden w-full md:block md:w-auto" id="navbar-default">
        <ul class="flex flex-col items-center p-4 mt-4 bg-gray-50 rounded-lg border border-gray-100 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
          <li>
            <a data-target="_self" href="https://maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Home</a>
          </li>
          <li>
            <a data-target="_self" href="https://maldevacademy.com/faq" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">FAQ</a>
          </li>
          <li>
            <a data-target="_self" href="https://maldevacademy.com/syllabus" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Syllabus</a>
          </li>
                              <li>
            <a data-target="_self" href="https://maldevacademy.com/pricing" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Pricing</a>
          </li>
                                        <li>
            <a data-target="_self" href="https://maldevacademy.com/profile" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Profile</a>
          </li>
          <li>
            <form action="https://maldevacademy.com/logout" method="POST">
            <input type="hidden" name="_token" value="YwmJrjvrFLFoheCqdySsfQHrDWEGzxTLXO7qfost">              <button type="submit" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Logout</button>
            </form>
          </li>
          <li class="mt-4 md:mt-0">
            <a data-target="_self" href="https://maldevacademy.com/modules" class="text-white bg-blue-700 hover:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center md:mr-3 mr-0 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Modules</a>
          </li>
                  </ul>
      </div>
    </div>
  </nav>        <div class="bg-gray-900 p-4">
    <div class="flex">
        <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700 border-l border-t border-gray-600 pl-4 pt-2 pb-2 rounded-tl">
            <div>
                Module 66 - Syscalls - Hell's Gate
            </div>
            <div class="ml-2 w-4 h-4 bg-orange-600 rounded-full"></div>
        </div>
        <div class="flex justify-end items-center w-1/2 bg-gray-700 pr-4 pt-2 pb-2 rounded-tr border-t border-r border-gray-600">
            <div class="enlarge-container pr-4">
                <img src="Syscalls%20-%20Hell's%20Gate_files/enlarge.svg" onclick="toggleScreenWidth()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="enlargeToggle" alt="Screen Width" width="20px">
            </div>
            <div class="objectives-container pr-4">
                <img src="Syscalls%20-%20Hell's%20Gate_files/objectives.svg" onclick="toggleObjectives()" class="hover:bg-gray-600 cursor-pointer" id="objectivesToggle" alt="Objectives" width="20px">
            </div>
            <div class="terminal-container ">
                <img src="Syscalls%20-%20Hell's%20Gate_files/ide.svg" onclick="toggleIde()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="terminalToggle" alt="Terminal" width="22px">
            </div>
                    </div>
    </div>
    <div id="height-container" class="flex h-full min-h-[800px]">
        <div class="flex max-w-full min-w-full">
            <div id="description-container" class="viewer code-description h-full bg-gray-800 p-4 border-r border-l border-b border-gray-600 px-5 md:px-10 lg:px-20 w-full"><div class="toastui-editor-contents" style="overflow-wrap: break-word;">
            <h2>Syscalls - Hell's Gate</h2>
<h3>Introduction</h3>
<p>Recall that using direct syscalls is a way to circumvent userland 
hooks by manually executing the assembly instructions of a syscall. 
Hell's Gate is another technique used to perform direct syscalls. By 
reading through <code>ntdll.dll</code>, Hell's Gate can dynamically find syscalls and then execute them from the binary.</p>
<p>The Hell's Gate paper is available <a href="https://vxug.fakedoma.in/papers/VXUG/Exclusive/HellsGate.pdf" target="_blank">here</a>.</p>
<h3>How Hell's Gate Works</h3>
<p>Previous modules demonstrated direct syscalls using SysWhispers. The 
SSN was either hard coded or found using the sorting by system call 
address method to determine the SSN at runtime. Hell's Gate, on the 
other hand, uses a different approach to finding the SSN.</p>
<p>Hell's Gate's approach works by searching for the SSN from within the
 hooked syscall's opcodes which are then called in its assembly 
functions.</p>
<h3>Hell's Gate Breakdown</h3>
<p>The complexity of the code requires the explanation to be broken into smaller subsections for easier understanding.</p>
<h4>Syscall Structure</h4>
<p>Hell's Gate code starts by defining the <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L8" target="_blank">VX_TABLE_ENTRY</a>
 structure. This structure represents a syscall and contains the 
address, the hash value of the syscall name and the SSN. The structure 
is shown below.</p>
<pre><code>typedef struct _VX_TABLE_ENTRY {
	PVOID   pAddress;             // The address of a syscall function
	DWORD64 dwHash;               // The hash value of the syscall name
	WORD    wSystemCall;          // The SSN of the syscall
} VX_TABLE_ENTRY, * PVX_TABLE_ENTRY;
</code></pre>
<p>For example, <code>NtAllocateVirtualMemory</code> would be represented as <code>VX_TABLE_ENTRY NtAllocateVirtualMemory</code>.</p>
<h4>Syscalls Table</h4>
<p>The syscalls that are being used are kept inside another structure, <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L14" target="_blank">VX_TABLE</a>. Since each member within <code>VX_TABLE</code> is a syscall, then each member will be of type <code>VX_TABLE_ENTRY</code>.</p>
<pre><code>typedef struct _VX_TABLE {
	VX_TABLE_ENTRY NtAllocateVirtualMemory;
	VX_TABLE_ENTRY NtProtectVirtualMemory;
	VX_TABLE_ENTRY NtCreateThreadEx;
	VX_TABLE_ENTRY NtWaitForSingleObject;
} VX_TABLE, * PVX_TABLE;
</code></pre>
<h4>Main Function</h4>
<p>The main function starts by calling the <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L50" target="_blank">RtlGetThreadEnvironmentBlock</a> function that is used to get the TEB. This is required to retrieve <code>ntdll.dll</code>'s base address via the PEB (recall the PEB is located within the TEB). Next, the export directory of <code>ntdll.dll</code> is fetched using <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L60" target="_blank">GetImageExportDirectory</a>. The export directory is found by parsing the <code>DOS</code> and <code>Nt</code> headers, as demonstrated in previous modules.</p>
<p>Next, for each syscall the <code>dwHash</code> member is initialized (e.g. <code>NtAllocateVirtualMemory.dwHash</code>) with its corresponding hash value. With each initialization, the <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L65" target="_blank">GetVxTableEntry</a> function is called, which is shown below. The function has been split into several parts to simplify the explanation process.</p>
<p><strong>GetVxTableEntry - Part 1</strong></p>
<pre><code>BOOL GetVxTableEntry(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY pImageExportDirectory, PVX_TABLE_ENTRY pVxTableEntry) {
	PDWORD pdwAddressOfFunctions    = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfFunctions);
	PDWORD pdwAddressOfNames        = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNames);
	PWORD pwAddressOfNameOrdinales  = (PWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNameOrdinals);

	for (WORD cx = 0; cx &lt; pImageExportDirectory-&gt;NumberOfNames; cx++) {
		PCHAR pczFunctionName  = (PCHAR)((PBYTE)pModuleBase + pdwAddressOfNames[cx]);
		PVOID pFunctionAddress = (PBYTE)pModuleBase + pdwAddressOfFunctions[pwAddressOfNameOrdinales[cx]];

		if (djb2(pczFunctionName) == pVxTableEntry-&gt;dwHash) {
			pVxTableEntry-&gt;pAddress = pFunctionAddress;

			// ...
		}
	}

	return TRUE;
}

</code></pre>
<p>Part one of the function searches for a Djb2 hash value equal to the syscall's hash, <code>pVxTableEntry-&gt;dwHash</code>. Once there is a match then the address of the syscall will be saved to <code>pVxTableEntry-&gt;pAddress</code>. The second part of the function is where the Hell's Gate trick resides.</p>
<p><strong>GetVxTableEntry - Part 2</strong></p>
<pre><code>			// Quick and dirty fix in case the function has been hooked
			WORD cw = 0;
			while (TRUE) {
				// check if syscall, in this case we are too far
				if (*((PBYTE)pFunctionAddress + cw) == 0x0f &amp;&amp; *((PBYTE)pFunctionAddress + cw + 1) == 0x05)
					return FALSE;

				// check if ret, in this case we are also probably too far
				if (*((PBYTE)pFunctionAddress + cw) == 0xc3)
					return FALSE;

				// First opcodes should be :
				//    MOV R10, RCX
				//    MOV RCX, &lt;syscall&gt;
				if (*((PBYTE)pFunctionAddress + cw) == 0x4c
					&amp;&amp; *((PBYTE)pFunctionAddress + 1 + cw) == 0x8b
					&amp;&amp; *((PBYTE)pFunctionAddress + 2 + cw) == 0xd1
					&amp;&amp; *((PBYTE)pFunctionAddress + 3 + cw) == 0xb8
					&amp;&amp; *((PBYTE)pFunctionAddress + 6 + cw) == 0x00
					&amp;&amp; *((PBYTE)pFunctionAddress + 7 + cw) == 0x00) {
					BYTE high = *((PBYTE)pFunctionAddress + 5 + cw);
					BYTE low = *((PBYTE)pFunctionAddress + 4 + cw);
					pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; 8) | low;
					break;
				}

				cw++;
			};
</code></pre>
<p>The second part begins with a while loop after finding the syscall address, <code>pFunctionAddress</code>. The while loop searches for the <code>0x4c, 0x8b, 0xd1, 0xb8</code> bytes which are opcodes for the <code>mov r10, rcx</code> and <code>mov rcx, ssn</code>, being the start of an unhooked syscall.</p>
<p>In the case where the syscall is hooked, the opcodes may not match 
due to the hook being added by security solutions prior to the <code>syscall</code> instruction. To address this, Hell's Gate attempts to match the opcodes, and if no match is found, the <code>cw</code>
 variable is incremented, which adds to the address of the syscall on 
the subsequent loop iteration. This progression continues, moving down 
one byte at a time until the <code>mov r10, rcx</code> and <code>mov rcx, ssn</code> instructions are reached. The image below illustrates how Hell's Gate finds the opcodes by traversing over the hook.</p>
<p><img src="Syscalls%20-%20Hell's%20Gate_files/hellsgate-114089998-966e34f8-c59b-4b3a-8c84-8d6014001a19.png" alt="image"></p>
<h4>Boundary Check</h4>
<p>To prevent itself from searching too far and obtaining a different 
SSN for a different syscall, two if-statements are made at the beginning
 of the while loop to check for the <code>syscall</code> and <code>ret</code> instructions located at the end of the syscall. If the search reaches one of these instructions and the <code>0x4c, 0x8b, 0xd1, 0xb8</code> opcodes have not been identified, resolving the SSN will fail.</p>
<pre><code>// check if syscall, in this case we are too far
if (*((PBYTE)pFunctionAddress + cw) == 0x0f &amp;&amp; *((PBYTE)pFunctionAddress + cw + 1) == 0x05)
	return FALSE;

// check if ret, in this case we are also probably too far
if (*((PBYTE)pFunctionAddress + cw) == 0xc3)
	return FALSE;
</code></pre>
<h4>Calculating &amp; Saving The SSN</h4>
<p>On the other hand, if there is a successful match for the opcodes, Hell's Gate will calculate the syscall number and save it to <code>pVxTableEntry-&gt;wSystemCall</code>.
 It is not necessary to understand the calculation, which requires 
knowledge of bitwise operators, however, those comfortable with the 
concept can continue reading this section.</p>
<p>The function first uses the left shift operator (<code>&lt;&lt;</code>) to shift the bits of the <code>high</code> variable to the left by 8 times. It then uses the bitwise OR operator (<code>|</code>) to compare each bit of the first operand (being <code>high &lt;&lt; 8</code>) to the corresponding bit of the second operand (being <code>low</code>).</p>
<pre><code>pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; 8) | low;
</code></pre>
<p>To better understand this, the following is an example using <code>NtProtectVirtualMemory</code> syscall to demonstrate the Hell's Gate approach in calculating the SSN.</p>
<p><img src="Syscalls%20-%20Hell's%20Gate_files/hellsgate-214097117-16ca9e20-17b3-427c-b0b0-b0e7ec78191c.png" alt="image"></p>
<p>The image above is simplified to the snippet below.</p>
<pre><code>00007FFCC42C4570 | 4C:8BD1                          | mov r10,rcx                                    |
00007FFCC42C4573 | B8 50000000                      | mov eax,50                                     | 50:'P'
00007FFCC42C4582 | 0F05                             | syscall                                        |
00007FFCC42C4584 | C3                               | ret                                            |
</code></pre>
<p>The <code>4C:8BD1 B8 50000000</code> bytes correspond to the following offsets:</p>
<p><code>4C</code> is offset 0, <code>8B</code> is offset 1 and <code>D1</code> is offset 2, <code>B8</code> is offset 3, <code>50</code> is offset 4, <code>00</code> is offset 5 and so on. The <code>GetVxTableEntry</code> function specifies that the <code>high</code> and <code>low</code> variables have an offset of 5 and 4, respectively.</p>
<pre><code>BYTE high = *((PBYTE)pFunctionAddress + 5 + cw); // Offset 5
BYTE low = *((PBYTE)pFunctionAddress + 4 + cw); // Offset 4
</code></pre>
<p>Checking the value at offset 5 reveals that it is <code>0x00</code>, while the offset at 4 is <code>0x50</code>. This means that the value of <code>high</code> is <code>0x00</code> and <code>low</code> is <code>0x50</code>. Therefore, the SSN is equal to <code>(0x00 &lt;&lt; 8) | 0x50</code>.</p>
<p><img src="Syscalls%20-%20Hell's%20Gate_files/hellsgate-314099314-0029aee9-f8c2-4436-a740-4c2964a952be.png" alt="image"></p>
<p>The result of the bitwise operation matches the SSN number of <code>NtProtectVirtualMemory</code>, which is 50 in hex.</p>
<p><img src="Syscalls%20-%20Hell's%20Gate_files/hellsgate-414099901-48434135-7e83-4cd5-aea6-94d1ef75f652.png" alt="image"></p>
<h3>Calling The Syscall</h3>
<p>Now that Hell's Gate has fully initialized the <code>VX_TABLE_ENTRY</code> structure of the target syscall, it can now call it. To do this, Hell's Gate uses two 64-bit assembly functions: <code>HellsGate</code> and <code>HellDescent</code>, shown in the <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/hellsgate.asm" target="_blank">hellsgate.asm</a> file.</p>
<pre><code>data
	wSystemCall DWORD 000h              ; this is a global variable used to keep the SSN of a syscall

.code 
	HellsGate PROC
		mov wSystemCall, 000h		
		mov wSystemCall, ecx            ; updating the 'wSystemCall' variable with input argument (ecx register's value)
		ret
	HellsGate ENDP

	HellDescent PROC
		mov r10, rcx
		mov eax, wSystemCall            ; `wSystemCall` is the SSN of the syscall to call
		syscall
		ret
	HellDescent ENDP
end
</code></pre>
<p>To call a syscall, first, the syscall number needs to be passed to the <code>HellsGate</code> function. This saves it to the <code>wSystemCall</code> global variable for future use. Next, <code>HellDescent</code> is used to call the syscall by passing the syscall's parameters. This is demonstrated in the <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L166" target="_blank">Payload</a> function.</p>
<h3>Conclusion</h3>
<p>It's been shown that bypassing userland hooks is possible through the
 use of direct syscalls, the SysWhispers tool and Hell's Gate technique.
 In upcoming modules, the process injection techniques previously 
implemented will be modified to utilize syscalls instead of WinAPIs.</p>

            </div></div>
            <div id="accessory-container" class="hidden flex flex-col w-1/4 min-w-1/4 h-full">
                <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-1/2">
                    <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                        
                                                                        
            <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Review the module thoroughly to understand how Hell's Gate works</label>
                            </div>
                                                                        
                                                                        
                    <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Analyze the HellsGate and HellDescent assembly functions and understand how they work</label>
                            </div>
                                                                        
                                                                        
                    <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-2" data-objective-id="2" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Compare SysWhispers' approach in retrieving a syscall's SSN with Hell's Gate's approach</label>
                            </div>
                                                                        
                                                                        
                    <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-3" data-objective-id="3" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Understand how Hell's Gate calculates the SSN</label>
                            </div>
                                                                                  
                </div>
                <div id="ide" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-1/2">
                    <textarea class="bg-gray-900 outline-0 w-full h-full resize-none font-sans" placeholder="Write temporary notes or code here"></textarea>
                </div>
            </div>  
        </div>
      </div>
      <div class="flex">
        <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700 border-r border-l border-gray-600 pl-4 pt-2 pb-2 rounded-bl rounded-br">
                        <div class="mr-2">
                <a data-target="_self" href="https://maldevacademy.com/modules/65"><button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Previous</button></a>           
            </div>
                        <div class="mr-2">
                <a data-target="_self" href="https://maldevacademy.com/modules"><button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Modules</button></a>           
            </div>
            <div class="my-2 mr-2">
            <form id="complete-module" action="https://maldevacademy.com/modules/66/complete" method="POST">
                <input type="hidden" name="_token" value="YwmJrjvrFLFoheCqdySsfQHrDWEGzxTLXO7qfost">                <button id="complete-btn" class="w-[100px] h-10 px-5 text-white text-sm duration-150 bg-green-700 rounded-lg focus:shadow-outline hover:bg-green-800 ">Complete</button>
            </form>
            <form id="uncomplete-module" action="https://maldevacademy.com/modules/66/progress" method="POST">
                <input type="hidden" name="_token" value="YwmJrjvrFLFoheCqdySsfQHrDWEGzxTLXO7qfost">                <button id="uncomplete-btn" class="w-[100px] h-10 px-5 text-white text-sm duration-150 bg-red-700 rounded-lg focus:shadow-outline hover:bg-red-800 hidden">Undo</button>
            </form>
            </div>
                                    <div class="mr-2">
                <a data-target="_self" href="https://maldevacademy.com/modules/67"><button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Next</button></a>           
            </div>
                    </div>
    </div>
</div>

<footer id="footer" class="text-gray-400 border-t-[1px] border-gray-700 bg-gray-900 body-font hidden">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4">© 2023 MalDev Academy</p>
        <a href="https://twitter.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
          Terms and Conditions
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
  </a></footer><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">        

        <script src="Syscalls%20-%20Hell's%20Gate_files/jquery-3.6.0.min.js"></script>
        <script src="Syscalls%20-%20Hell's%20Gate_files/bootstrap.min.js"></script>
        <link rel="preload" as="style" href="Syscalls%20-%20Hell's%20Gate_files/app.4474f4d1.css"><link rel="modulepreload" href="Syscalls%20-%20Hell's%20Gate_files/app.5f3af5ce.js"><link rel="stylesheet" href="Syscalls%20-%20Hell's%20Gate_files/app.4474f4d1.css"><script type="module" src="Syscalls%20-%20Hell's%20Gate_files/app.5f3af5ce.js"></script><script src="Syscalls%20-%20Hell's%20Gate_files/navbar.js"></script>
<script src="Syscalls%20-%20Hell's%20Gate_files/moduleviewer.js"></script>

 
<script>
$(document).ready(function() {
    $('a:not([data-target="_self"])').attr('target', '_blank');

    $('input[type=checkbox]').change(function() {
    var checked = $(this).is(':checked');
    var userId = 260;
    var moduleId = 66;
    var objectiveId = $(this).data('objective-id');
    $.ajax({
        url: checked ? "https://maldevacademy.com/complete/objective" : "https://maldevacademy.com/remove/objective",
        type: "POST",
        data: {
        _token: "YwmJrjvrFLFoheCqdySsfQHrDWEGzxTLXO7qfost",
        user_id: userId,
        module_id: moduleId,
        objective_id: objectiveId
        },
        success: function(response) {

        },
        error: function(xhr) {
        console.log('Error');
        }
    });
    });

    $('#complete-module').submit(function(event) {
    event.preventDefault(); // Prevent default form submission

    var form = $(this);
    var url = form.attr('action');
    var data = form.serialize();
    var completeBtn = form.find('#complete-btn');
    var uncompleteBtn = $('#uncomplete-btn');

    $.ajax({
        type: 'POST',
        url: url,
        data: data,
        success: function(response) {
            completeBtn.addClass('hidden');
            uncompleteBtn.removeClass('hidden');
        },
        error: function(xhr) {
            console.log('Error');
        }
    });
});

$('#uncomplete-module').submit(function(event) {
    event.preventDefault(); // Prevent default form submission

    var form = $(this);
    var url = form.attr('action');
    var data = form.serialize();
    var completeBtn = $('#complete-btn');
    var uncompleteBtn = form.find('#uncomplete-btn');

    $.ajax({
        type: 'POST',
        url: url,
        data: data,
        success: function(response) {
            uncompleteBtn.addClass('hidden');
            completeBtn.removeClass('hidden');
        },
        error: function(xhr) {
            console.log('Error');
        }
    });
});
});
</script>
    
</a></body></html>